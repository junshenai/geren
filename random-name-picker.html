<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>随机点名系统</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4F46E5',
                        secondary: '#EC4899',
                        accent: '#10B981',
                        dark: '#1E293B',
                        light: '#F8FAFC'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    animation: {
                        'spin-fast': 'spin 0.2s linear infinite',
                        'bounce-slow': 'bounce 2s infinite',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'scale-up': 'scaleUp 0.5s ease-out forwards',
                        'celebrate': 'celebrate 0.8s ease-out infinite alternate',
                        'float': 'float 3s ease-in-out infinite',
                    },
                    keyframes: {
                        scaleUp: {
                            '0%': { transform: 'scale(0.8)', opacity: '0' },
                            '100%': { transform: 'scale(1)', opacity: '1' },
                        },
                        celebrate: {
                            '0%': { transform: 'scale(1) translateY(0)' },
                            '100%': { transform: 'scale(1.1) translateY(-10px)' },
                        },
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        }
                    }
                },
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }
            .text-shadow-lg {
                text-shadow: 0 4px 8px rgba(0, 0, 0, 0.25);
            }
            .bg-gradient-cute {
                background: linear-gradient(135deg, #F9F5FF 0%, #F0F9FF 50%, #ECFEFF 100%);
            }
            .card-glass {
                backdrop-filter: blur(12px);
                background: rgba(255, 255, 255, 0.7);
            }
            .confetti {
                position: absolute;
                width: 10px;
                height: 10px;
                opacity: 0;
            }
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-cute flex flex-col items-center justify-center font-sans">
    <!-- 头部 -->
    <header class="w-full text-center mb-8">
        <h1 class="text-[clamp(2rem,5vw,3.5rem)] font-bold text-primary text-shadow-lg mb-2">
            <i class="fa fa-star text-yellow-400 animate-pulse"></i> 
            随机点名系统
            <i class="fa fa-star text-yellow-400 animate-pulse"></i>
        </h1>
        <p class="text-dark/70 text-lg max-w-2xl mx-auto">
            点击按钮，让幸运儿脱颖而出！<span class="text-primary font-medium">被选中的同学将获得特别的惊喜！</span>
        </p>
    </header>

    <!-- 主要内容 -->
    <main class="w-full max-w-4xl px-4 py-8">
        <!-- 显示区域 -->
        <div class="card-glass rounded-3xl shadow-2xl p-8 mb-8 transition-all duration-300 hover:shadow-xl">
            <div id="name-display" class="text-[clamp(2.5rem,8vw,5rem)] font-extrabold text-center py-12 rounded-2xl bg-white/80 shadow-inner">
                <span class="text-dark/50">准备好了吗？</span>
            </div>
            
            <!-- 控制面板 -->
            <div class="flex flex-col md:flex-row gap-4 justify-center mt-8">
                <button id="start-btn" class="bg-primary hover:bg-primary/90 text-white py-4 px-10 rounded-full text-xl font-bold transition-all duration-300 transform hover:scale-105 hover:shadow-lg active:scale-95 flex items-center justify-center gap-2">
                    <i class="fa fa-play"></i> 开始点名
                </button>
                <button id="stop-btn" class="bg-secondary hover:bg-secondary/90 text-white py-4 px-10 rounded-full text-xl font-bold transition-all duration-300 transform hover:scale-105 hover:shadow-lg active:scale-95 flex items-center justify-center gap-2" disabled>
                    <i class="fa fa-stop"></i> 停止
                </button>
                <button id="reset-btn" class="bg-gray-200 hover:bg-gray-300 text-dark py-4 px-8 rounded-full text-xl font-bold transition-all duration-300 transform hover:scale-105 hover:shadow-md active:scale-95 flex items-center justify-center gap-2">
                    <i class="fa fa-refresh"></i> 重置
                </button>
            </div>
        </div>

        <!-- 额外信息 -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <!-- 统计信息 -->
            <div class="card-glass rounded-2xl p-6 shadow-lg">
                <h3 class="text-xl font-bold text-dark mb-4 flex items-center gap-2">
                    <i class="fa fa-bar-chart text-accent"></i> 统计信息
                </h3>
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-white/70 rounded-xl p-4 text-center">
                        <p class="text-dark/70 text-sm">总人数</p>
                        <p id="total-count" class="text-3xl font-bold text-primary">0</p>
                    </div>
                    <div class="bg-white/70 rounded-xl p-4 text-center">
                        <p class="text-dark/70 text-sm">已点名</p>
                        <p id="picked-count" class="text-3xl font-bold text-accent">0</p>
                    </div>
                </div>
            </div>

            <!-- 最近点名 -->
            <div class="card-glass rounded-2xl p-6 shadow-lg">
                <h3 class="text-xl font-bold text-dark mb-4 flex items-center gap-2">
                    <i class="fa fa-history text-secondary"></i> 最近点名
                </h3>
                <div id="recent-list" class="bg-white/70 rounded-xl p-4 max-h-32 overflow-y-auto">
                    <p class="text-dark/50 text-center">暂无记录</p>
                </div>
            </div>
        </div>

        <!-- 学生列表 -->
        <div class="card-glass rounded-2xl p-6 shadow-lg">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-dark flex items-center gap-2">
                    <i class="fa fa-users text-primary"></i> 班级名单
                </h3>
                <button id="toggle-list" class="text-primary hover:text-primary/80 transition-colors">
                    <i class="fa fa-chevron-down"></i>
                </button>
            </div>
            
            <!-- 导入学生名单功能 -->
            <div class="mb-6 p-4 bg-white/70 rounded-xl">
                <h4 class="text-lg font-semibold text-dark mb-3 flex items-center gap-2">
                    <i class="fa fa-upload text-accent"></i> 导入自定义名单
                </h4>
                <div class="space-y-4">
                    <!-- 文件上传 -->
                    <div>
                        <label class="block text-sm font-medium text-dark/70 mb-1">上传文本文件 (.txt)</label>
                        <input type="file" id="file-input" accept=".txt" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50">
                        <p class="text-xs text-dark/50 mt-1">每行一个学生姓名</p>
                    </div>
                    
                    <!-- 手动输入 -->
                    <div>
                        <label class="block text-sm font-medium text-dark/70 mb-1">或手动输入</label>
                        <textarea id="name-input" rows="4" placeholder="请输入学生姓名，每行一个" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"></textarea>
                    </div>
                    
                    <!-- 操作按钮 -->
                    <div class="flex gap-3">
                        <button id="import-btn" class="flex-1 bg-accent hover:bg-accent/90 text-white py-2 px-4 rounded-lg font-medium transition-all duration-300 transform hover:scale-105 active:scale-95 flex items-center justify-center gap-2">
                            <i class="fa fa-check"></i> 导入名单
                        </button>
                        <button id="clear-input-btn" class="bg-gray-200 hover:bg-gray-300 text-dark py-2 px-4 rounded-lg font-medium transition-all duration-300 transform hover:scale-105 active:scale-95 flex items-center justify-center gap-2">
                            <i class="fa fa-trash"></i> 清空
                        </button>
                    </div>
                </div>
            </div>
            
            <div id="name-list" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-2 max-h-60 overflow-y-auto transition-all duration-300">
                <!-- 学生名单将动态生成 -->
            </div>
        </div>
    </main>

    <!-- 页脚 -->
    <footer class="w-full text-center text-dark/60 py-4 mt-8">
        <p>© 2025 随机点名系统 - 让课堂更加精彩！</p>
    </footer>

    <!-- 庆祝动画容器 -->
    <div id="confetti-container" class="fixed inset-0 pointer-events-none overflow-hidden z-50"></div>

    <script>
        // 学生名单
        const studentNames = [
            '郭一涵', '毕梓涵', '王言竹', '周芸萍', '王晓玉',
            '高雨', '林凯', '赵世涵', '宋佳怡', '司雯竹',
            '刘嘉贺', '于卓然', '刘易航', '常瑞心', '马一恒',
            '曲心悦', '李明翰', '佟思宇', '程纪', '李书瑶',
            '李奕豪', '董琪', '尹智博', '姜依娜', '金悦',
            '于鑫博', '李冲', '李思露', '宋明远', '尹春旭',
            '李家燊', '张云溥', '王舒依', '冯柏潼', '张翼飞',
            '谢文博', '乌云毕力格', '徐若希', '贾淇元', '姜士聪',
            '尚思彤', '丁雨行', '郑紫萌', '梁楠', '郝佳怡',
            '侯悦', '黄子涵', '朱立航', '李宇涵', '周兴达'
        ];

        // 状态
        let isRolling = false;
        let rollInterval = null;
        let availableNames = [...studentNames];
        let pickedNames = [];
        let recentPicks = [];

        // DOM 元素
        const nameDisplay = document.getElementById('name-display');
        const startBtn = document.getElementById('start-btn');
        const stopBtn = document.getElementById('stop-btn');
        const resetBtn = document.getElementById('reset-btn');
        const nameList = document.getElementById('name-list');
        const toggleList = document.getElementById('toggle-list');
        const totalCount = document.getElementById('total-count');
        const pickedCount = document.getElementById('picked-count');
        const recentList = document.getElementById('recent-list');
        const confettiContainer = document.getElementById('confetti-container');
        
        // 导入功能元素
        const fileInput = document.getElementById('file-input');
        const nameInput = document.getElementById('name-input');
        const importBtn = document.getElementById('import-btn');
        const clearInputBtn = document.getElementById('clear-input-btn');

        // 初始化
        function init() {
            renderNameList();
            updateStats();
            updateRecentList();
            
            // 绑定事件
            startBtn.addEventListener('click', startRolling);
            stopBtn.addEventListener('click', stopRolling);
            resetBtn.addEventListener('click', resetAll);
            toggleList.addEventListener('click', toggleNameList);
            
            // 导入功能事件
            importBtn.addEventListener('click', importCustomList);
            clearInputBtn.addEventListener('click', clearInputFields);
            fileInput.addEventListener('change', handleFileUpload);
        }
        
        // 处理文件上传
        function handleFileUpload(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                nameInput.value = content;
            };
            reader.readAsText(file, 'UTF-8');
        }
        
        // 导入自定义名单
        function importCustomList() {
            const inputText = nameInput.value.trim();
            if (!inputText) {
                alert('请输入学生名单或上传文件');
                return;
            }
            
            // 解析名单，每行一个姓名
            const customNames = inputText.split('\n')
                .map(name => name.trim())
                .filter(name => name !== '');
            
            if (customNames.length === 0) {
                alert('未找到有效的学生姓名');
                return;
            }
            
            // 更新学生名单
            studentNames.length = 0;
            studentNames.push(...customNames);
            
            // 重置状态
            resetAll();
            
            // 显示成功消息
            alert(`成功导入 ${customNames.length} 个学生姓名`);
        }
        
        // 清空输入字段
        function clearInputFields() {
            nameInput.value = '';
            fileInput.value = '';
        }

        // 渲染学生列表
        function renderNameList() {
            nameList.innerHTML = '';
            studentNames.forEach(name => {
                const isPicked = pickedNames.includes(name);
                const nameElement = document.createElement('div');
                nameElement.className = `py-2 px-3 rounded-lg text-center transition-all duration-300 ${
                    isPicked 
                        ? 'bg-gray-100 text-gray-400 line-through'
                        : 'bg-white/70 hover:bg-primary/10 cursor-pointer'
                }`;
                nameElement.textContent = name;
                nameList.appendChild(nameElement);
            });
        }

        // 更新统计信息
        function updateStats() {
            totalCount.textContent = studentNames.length;
            pickedCount.textContent = pickedNames.length;
        }

        // 更新最近点名列表
        function updateRecentList() {
            if (recentPicks.length === 0) {
                recentList.innerHTML = '<p class="text-dark/50 text-center">暂无记录</p>';
                return;
            }
            
            recentList.innerHTML = '';
            recentPicks.forEach((name, index) => {
                const item = document.createElement('div');
                item.className = 'flex items-center justify-between py-1';
                item.innerHTML = `
                    <span class="font-medium">${name}</span>
                    <span class="text-sm text-dark/60">${index + 1}</span>
                `;
                recentList.appendChild(item);
            });
        }

        // 切换名单显示
        function toggleNameList() {
            const icon = toggleList.querySelector('i');
            if (nameList.style.maxHeight) {
                nameList.style.maxHeight = null;
                icon.className = 'fa fa-chevron-down';
            } else {
                nameList.style.maxHeight = nameList.scrollHeight + 'px';
                icon.className = 'fa fa-chevron-up';
            }
        }

        // 开始滚动
        function startRolling() {
            if (isRolling || availableNames.length === 0) return;
            
            isRolling = true;
            startBtn.disabled = true;
            stopBtn.disabled = false;
            resetBtn.disabled = true;
            
            // 添加动画效果
            nameDisplay.classList.add('animate-pulse-slow');
            nameDisplay.style.backgroundColor = 'rgba(255, 255, 255, 0.9)';
            
            let counter = 0;
            rollInterval = setInterval(() => {
                // 随着时间推移加快速度
                const speedFactor = Math.min(1, counter / 10);
                const randomIndex = Math.floor(Math.random() * availableNames.length);
                const randomName = availableNames[randomIndex];
                
                // 变化颜色和大小以增强视觉效果
                const hue = Math.floor(Math.random() * 60) + 200; // 蓝色到紫色的范围
                const fontSize = Math.random() * 10 + 90; // 90%到100%的字体大小
                
                nameDisplay.innerHTML = `
                    <span style="color: hsl(${hue}, 70%, 50%); font-size: ${fontSize}%">
                        ${randomName}
                    </span>
                `;
                
                counter++;
            }, 50); // 初始速度
        }

        // 停止滚动
        function stopRolling() {
            if (!isRolling) return;
            
            // 逐渐减速停止
            clearInterval(rollInterval);
            let slowCounter = 0;
            const slowInterval = setInterval(() => {
                slowCounter++;
                const randomIndex = Math.floor(Math.random() * availableNames.length);
                const randomName = availableNames[randomIndex];
                
                nameDisplay.innerHTML = `
                    <span style="color: hsl(${Math.floor(Math.random() * 60) + 200}, 70%, 50%);">
                        ${randomName}
                    </span>
                `;
                
                if (slowCounter >= 10) {
                    clearInterval(slowInterval);
                    finalizeSelection();
                }
            }, 100 * slowCounter + 50);
        }

        // 最终确定选中的学生
        function finalizeSelection() {
            if (availableNames.length === 0) return;
            
            const finalIndex = Math.floor(Math.random() * availableNames.length);
            const selectedName = availableNames[finalIndex];
            
            // 更新状态
            availableNames.splice(finalIndex, 1);
            pickedNames.push(selectedName);
            recentPicks.unshift(selectedName);
            if (recentPicks.length > 5) recentPicks.pop();
            
            // 更新UI
            isRolling = false;
            startBtn.disabled = availableNames.length === 0;
            stopBtn.disabled = true;
            resetBtn.disabled = false;
            
            // 添加庆祝效果
            nameDisplay.classList.remove('animate-pulse-slow');
            nameDisplay.classList.add('animate-celebrate');
            nameDisplay.style.backgroundColor = 'rgba(236, 72, 153, 0.1)';
            nameDisplay.innerHTML = `
                <span class="text-secondary text-shadow-lg">
                    <i class="fa fa-trophy text-yellow-500 mr-2"></i>
                    ${selectedName}
                    <i class="fa fa-trophy text-yellow-500 ml-2"></i>
                </span>
            `;
            
            // 发射庆祝彩带
            launchConfetti();
            
            // 更新列表和统计
            renderNameList();
            updateStats();
            updateRecentList();
            
            // 一段时间后恢复正常显示
            setTimeout(() => {
                nameDisplay.classList.remove('animate-celebrate');
                nameDisplay.style.backgroundColor = 'rgba(255, 255, 255, 0.8)';
            }, 3000);
        }

        // 发射庆祝彩带
        function launchConfetti() {
            confettiContainer.innerHTML = '';
            
            const colors = ['#4F46E5', '#EC4899', '#10B981', '#F59E0B', '#8B5CF6'];
            const confettiCount = 150;
            
            for (let i = 0; i < confettiCount; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                
                // 随机大小、形状和颜色
                const size = Math.random() * 10 + 5;
                const color = colors[Math.floor(Math.random() * colors.length)];
                const isCircle = Math.random() > 0.5;
                
                confetti.style.width = `${size}px`;
                confetti.style.height = `${size}px`;
                confetti.style.backgroundColor = color;
                confetti.style.borderRadius = isCircle ? '50%' : '0';
                
                // 随机初始位置
                confetti.style.left = `${Math.random() * 100}vw`;
                confetti.style.top = '-20px';
                
                // 随机动画
                const duration = Math.random() * 5 + 3;
                const delay = Math.random() * 2;
                const rotation = Math.random() * 360;
                const xOffset = Math.random() * 100 - 50;
                
                confetti.style.animation = `falling ${duration}s ease-in-out ${delay}s forwards`;
                confetti.style.transform = `rotate(${rotation}deg)`;
                
                confettiContainer.appendChild(confetti);
                
                // 动态创建下落动画
                const keyframes = `
                    @keyframes falling {
                        0% {
                            transform: translateY(0) translateX(0) rotate(${rotation}deg);
                            opacity: 1;
                        }
                        100% {
                            transform: translateY(100vh) translateX(${xOffset}px) rotate(${rotation + 360}deg);
                            opacity: 0;
                        }
                    }
                `;
                
                const style = document.createElement('style');
                style.textContent = keyframes;
                document.head.appendChild(style);
                
                // 动画结束后清理
                setTimeout(() => {
                    document.head.removeChild(style);
                }, (duration + delay) * 1000);
            }
            
            // 清除所有彩带
            setTimeout(() => {
                confettiContainer.innerHTML = '';
            }, 8000);
        }

        // 重置所有
        function resetAll() {
            clearInterval(rollInterval);
            
            // 重置状态
            isRolling = false;
            availableNames = [...studentNames];
            pickedNames = [];
            recentPicks = [];
            
            // 重置UI
            startBtn.disabled = false;
            stopBtn.disabled = true;
            resetBtn.disabled = false;
            
            nameDisplay.classList.remove('animate-pulse-slow', 'animate-celebrate');
            nameDisplay.style.backgroundColor = 'rgba(255, 255, 255, 0.8)';
            nameDisplay.innerHTML = '<span class="text-dark/50">准备好了吗？</span>';
            
            // 更新所有列表和统计
            renderNameList();
            updateStats();
            updateRecentList();
            
            // 清除彩带
            confettiContainer.innerHTML = '';
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>